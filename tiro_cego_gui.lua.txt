-- Tiro Cego || By Branz
-- Script GUI com Loading Screen e Funcionalidades

local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local TweenService = game:GetService("TweenService")
local UserInputService = game:GetService("UserInputService")

local player = Players.LocalPlayer
local playerGui = player:WaitForChild("PlayerGui")

-- Variáveis globais
local viewPlayersEnabled = false
local espEnabled = false
local espObjects = {}

-- Função para criar a tela de carregamento
local function createLoadingScreen()
    local screenGui = Instance.new("ScreenGui")
    screenGui.Name = "LoadingScreen"
    screenGui.ResetOnSpawn = false
    screenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
    screenGui.Parent = playerGui

    local frame = Instance.new("Frame")
    frame.Size = UDim2.new(1, 0, 1, 0)
    frame.BackgroundColor3 = Color3.fromRGB(15, 15, 20)
    frame.BorderSizePixel = 0
    frame.Parent = screenGui

    local gradient = Instance.new("UIGradient")
    gradient.Color = ColorSequence.new{
        ColorSequenceKeypoint.new(0, Color3.fromRGB(25, 25, 40)),
        ColorSequenceKeypoint.new(1, Color3.fromRGB(10, 10, 15))
    }
    gradient.Rotation = 45
    gradient.Parent = frame

    local title = Instance.new("TextLabel")
    title.Size = UDim2.new(0, 400, 0, 80)
    title.Position = UDim2.new(0.5, 0, 0.35, 0)
    title.AnchorPoint = Vector2.new(0.5, 0.5)
    title.BackgroundTransparency = 1
    title.Text = "TIRO CEGO"
    title.TextColor3 = Color3.fromRGB(255, 255, 255)
    title.Font = Enum.Font.GothamBold
    title.TextSize = 48
    title.TextTransparency = 1
    title.Parent = frame

    local subtitle = Instance.new("TextLabel")
    subtitle.Size = UDim2.new(0, 300, 0, 40)
    subtitle.Position = UDim2.new(0.5, 0, 0.45, 0)
    subtitle.AnchorPoint = Vector2.new(0.5, 0.5)
    subtitle.BackgroundTransparency = 1
    subtitle.Text = "By Branz"
    subtitle.TextColor3 = Color3.fromRGB(150, 150, 200)
    subtitle.Font = Enum.Font.Gotham
    subtitle.TextSize = 20
    subtitle.TextTransparency = 1
    subtitle.Parent = frame

    local loadingBar = Instance.new("Frame")
    loadingBar.Size = UDim2.new(0, 400, 0, 6)
    loadingBar.Position = UDim2.new(0.5, 0, 0.6, 0)
    loadingBar.AnchorPoint = Vector2.new(0.5, 0.5)
    loadingBar.BackgroundColor3 = Color3.fromRGB(40, 40, 50)
    loadingBar.BorderSizePixel = 0
    loadingBar.Parent = frame

    local loadingBarFill = Instance.new("Frame")
    loadingBarFill.Size = UDim2.new(0, 0, 1, 0)
    loadingBarFill.BackgroundColor3 = Color3.fromRGB(100, 150, 255)
    loadingBarFill.BorderSizePixel = 0
    loadingBarFill.Parent = loadingBar

    local barGradient = Instance.new("UIGradient")
    barGradient.Color = ColorSequence.new{
        ColorSequenceKeypoint.new(0, Color3.fromRGB(80, 120, 255)),
        ColorSequenceKeypoint.new(1, Color3.fromRGB(150, 180, 255))
    }
    barGradient.Parent = loadingBarFill

    local corner = Instance.new("UICorner")
    corner.CornerRadius = UDim.new(0, 3)
    corner.Parent = loadingBar

    local corner2 = Instance.new("UICorner")
    corner2.CornerRadius = UDim.new(0, 3)
    corner2.Parent = loadingBarFill

    local loadingText = Instance.new("TextLabel")
    loadingText.Size = UDim2.new(0, 400, 0, 30)
    loadingText.Position = UDim2.new(0.5, 0, 0.65, 0)
    loadingText.AnchorPoint = Vector2.new(0.5, 0.5)
    loadingText.BackgroundTransparency = 1
    loadingText.Text = "Carregando... 0%"
    loadingText.TextColor3 = Color3.fromRGB(180, 180, 200)
    loadingText.Font = Enum.Font.Gotham
    loadingText.TextSize = 16
    loadingText.TextTransparency = 1
    loadingText.Parent = frame

    -- Animações
    TweenService:Create(title, TweenInfo.new(0.8), {TextTransparency = 0}):Play()
    TweenService:Create(subtitle, TweenInfo.new(0.8, Enum.EasingStyle.Quad, Enum.EasingDirection.Out, 0, false, 0.2), {TextTransparency = 0}):Play()
    TweenService:Create(loadingText, TweenInfo.new(0.8, Enum.EasingStyle.Quad, Enum.EasingDirection.Out, 0, false, 0.4), {TextTransparency = 0}):Play()

    -- Simular carregamento
    for i = 0, 100, 2 do
        wait(0.03)
        loadingBarFill.Size = UDim2.new(i / 100, 0, 1, 0)
        loadingText.Text = "Carregando... " .. i .. "%"
    end

    wait(0.5)
    TweenService:Create(frame, TweenInfo.new(0.5), {BackgroundTransparency = 1}):Play()
    TweenService:Create(title, TweenInfo.new(0.5), {TextTransparency = 1}):Play()
    TweenService:Create(subtitle, TweenInfo.new(0.5), {TextTransparency = 1}):Play()
    TweenService:Create(loadingText, TweenInfo.new(0.5), {TextTransparency = 1}):Play()
    TweenService:Create(loadingBar, TweenInfo.new(0.5), {BackgroundTransparency = 1}):Play()
    TweenService:Create(loadingBarFill, TweenInfo.new(0.5), {BackgroundTransparency = 1}):Play()
    wait(0.5)
    screenGui:Destroy()
end

-- Função para criar ESP com esqueleto RGB
local function createESP(targetPlayer)
    if targetPlayer == player then return end
    
    local espFolder = Instance.new("Folder")
    espFolder.Name = "ESP_" .. targetPlayer.Name
    espFolder.Parent = game.CoreGui
    
    local billboardGui = Instance.new("BillboardGui")
    billboardGui.Name = "NameTag"
    billboardGui.AlwaysOnTop = true
    billboardGui.Size = UDim2.new(0, 200, 0, 50)
    billboardGui.StudsOffset = Vector3.new(0, 3, 0)
    billboardGui.Parent = espFolder
    
    local nameLabel = Instance.new("TextLabel")
    nameLabel.Size = UDim2.new(1, 0, 0.5, 0)
    nameLabel.BackgroundTransparency = 1
    nameLabel.Text = targetPlayer.Name
    nameLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
    nameLabel.Font = Enum.Font.GothamBold
    nameLabel.TextSize = 16
    nameLabel.TextStrokeTransparency = 0.5
    nameLabel.Parent = billboardGui
    
    local distanceLabel = Instance.new("TextLabel")
    distanceLabel.Size = UDim2.new(1, 0, 0.5, 0)
    distanceLabel.Position = UDim2.new(0, 0, 0.5, 0)
    distanceLabel.BackgroundTransparency = 1
    distanceLabel.Text = "0m"
    distanceLabel.TextColor3 = Color3.fromRGB(200, 200, 255)
    distanceLabel.Font = Enum.Font.Gotham
    distanceLabel.TextSize = 14
    distanceLabel.TextStrokeTransparency = 0.5
    distanceLabel.Parent = billboardGui
    
    local skeletonParts = {}
    local connections = {}
    
    espObjects[targetPlayer] = {folder = espFolder, skeleton = skeletonParts, connections = connections}
    
    local function createBeam(attachment0, attachment1)
        local beam = Instance.new("Beam")
        beam.Attachment0 = attachment0
        beam.Attachment1 = attachment1
        beam.Width0 = 0.1
        beam.Width1 = 0.1
        beam.FaceCamera = true
        beam.Segments = 1
        return beam
    end
    
    local function updateSkeleton()
        if not espEnabled or not targetPlayer.Character then return end
        
        local character = targetPlayer.Character
        local humanoid = character:FindFirstChild("Humanoid")
        if not humanoid then return end
        
        -- Limpar esqueleto antigo
        for _, part in pairs(skeletonParts) do
            if part then part:Destroy() end
        end
        skeletonParts = {}
        
        -- Criar attachments e beams para o esqueleto
        local parts = {
            Head = character:FindFirstChild("Head"),
            Torso = character:FindFirstChild("Torso") or character:FindFirstChild("UpperTorso"),
            LeftArm = character:FindFirstChild("Left Arm") or character:FindFirstChild("LeftUpperArm"),
            RightArm = character:FindFirstChild("Right Arm") or character:FindFirstChild("RightUpperArm"),
            LeftLeg = character:FindFirstChild("Left Leg") or character:FindFirstChild("LeftUpperLeg"),
            RightLeg = character:FindFirstChild("Right Leg") or character:FindFirstChild("RightUpperLeg")
        }
        
        if not parts.Torso then return end
        
        -- Criar attachments
        local attachments = {}
        for name, part in pairs(parts) do
            if part then
                local att = Instance.new("Attachment")
                att.Parent = part
                attachments[name] = att
            end
        end
        
        -- Criar beams (conexões do esqueleto)
        local beamConnections = {
            {attachments.Head, attachments.Torso},
            {attachments.Torso, attachments.LeftArm},
            {attachments.Torso, attachments.RightArm},
            {attachments.Torso, attachments.LeftLeg},
            {attachments.Torso, attachments.RightLeg}
        }
        
        for _, connection in pairs(beamConnections) do
            if connection[1] and connection[2] then
                local beam = createBeam(connection[1], connection[2])
                beam.Parent = game.CoreGui
                table.insert(skeletonParts, beam)
            end
        end
    end
    
    local rgbConnection
    rgbConnection = RunService.RenderStepped:Connect(function()
        if not espEnabled or not targetPlayer.Character or not targetPlayer.Character:FindFirstChild("HumanoidRootPart") then
            return
        end
        
        local character = targetPlayer.Character
        local hrp = character.HumanoidRootPart
        
        if player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
            local distance = (player.Character.HumanoidRootPart.Position - hrp.Position).Magnitude
            distanceLabel.Text = math.floor(distance) .. "m"
        end
        
        billboardGui.Adornee = hrp
        
        -- Atualizar cor RGB do esqueleto
        local hue = tick() % 5 / 5
        local color = Color3.fromHSV(hue, 1, 1)
        
        for _, beam in pairs(skeletonParts) do
            if beam and beam:IsA("Beam") then
                beam.Color = ColorSequence.new(color)
            end
        end
    end)
    
    table.insert(connections, rgbConnection)
    
    -- Atualizar esqueleto quando personagem é adicionado
    if targetPlayer.Character then
        updateSkeleton()
    end
    
    targetPlayer.CharacterAdded:Connect(function()
        wait(0.5)
        updateSkeleton()
    end)
end

-- Função View Players
local function toggleViewPlayers(enabled)
    viewPlayersEnabled = enabled
    for _, targetPlayer in pairs(Players:GetPlayers()) do
        if targetPlayer ~= player and targetPlayer.Character then
            for _, part in pairs(targetPlayer.Character:GetDescendants()) do
                if part:IsA("BasePart") then
                    part.LocalTransparencyModifier = enabled and 0 or part.Transparency
                end
            end
        end
    end
end

-- Função ESP Players
local function toggleESP(enabled)
    espEnabled = enabled
    if enabled then
        for _, targetPlayer in pairs(Players:GetPlayers()) do
            createESP(targetPlayer)
        end
        
        Players.PlayerAdded:Connect(function(targetPlayer)
            if espEnabled then
                targetPlayer.CharacterAdded:Connect(function()
                    wait(0.5)
                    createESP(targetPlayer)
                end)
            end
        end)
    else
        for _, espData in pairs(espObjects) do
            if espData and espData.folder then
                espData.folder:Destroy()
            end
            if espData and espData.connections then
                for _, conn in pairs(espData.connections) do
                    if conn then conn:Disconnect() end
                end
            end
            if espData and espData.skeleton then
                for _, part in pairs(espData.skeleton) do
                    if part then part:Destroy() end
                end
            end
        end
        espObjects = {}
    end
end

-- Criar GUI principal
local function createMainGUI()
    local screenGui = Instance.new("ScreenGui")
    screenGui.Name = "TiroCegoGUI"
    screenGui.ResetOnSpawn = false
    screenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
    screenGui.Parent = playerGui

    local mainFrame = Instance.new("Frame")
    mainFrame.Name = "MainFrame"
    mainFrame.Size = UDim2.new(0, 350, 0, 200)
    mainFrame.Position = UDim2.new(0.5, -175, 0.5, -100)
    mainFrame.BackgroundColor3 = Color3.fromRGB(25, 25, 35)
    mainFrame.BorderSizePixel = 0
    mainFrame.Parent = screenGui

    local corner = Instance.new("UICorner")
    corner.CornerRadius = UDim.new(0, 10)
    corner.Parent = mainFrame

    local shadow = Instance.new("ImageLabel")
    shadow.Name = "Shadow"
    shadow.BackgroundTransparency = 1
    shadow.Position = UDim2.new(0, -15, 0, -15)
    shadow.Size = UDim2.new(1, 30, 1, 30)
    shadow.ZIndex = 0
    shadow.Image = "rbxasset://textures/ui/GuiImagePlaceholder.png"
    shadow.ImageColor3 = Color3.fromRGB(0, 0, 0)
    shadow.ImageTransparency = 0.5
    shadow.Parent = mainFrame

    local titleBar = Instance.new("Frame")
    titleBar.Name = "TitleBar"
    titleBar.Size = UDim2.new(1, 0, 0, 40)
    titleBar.BackgroundColor3 = Color3.fromRGB(35, 35, 50)
    titleBar.BorderSizePixel = 0
    titleBar.Parent = mainFrame

    local titleCorner = Instance.new("UICorner")
    titleCorner.CornerRadius = UDim.new(0, 10)
    titleCorner.Parent = titleBar

    local titleBarBottom = Instance.new("Frame")
    titleBarBottom.Size = UDim2.new(1, 0, 0, 10)
    titleBarBottom.Position = UDim2.new(0, 0, 1, -10)
    titleBarBottom.BackgroundColor3 = Color3.fromRGB(35, 35, 50)
    titleBarBottom.BorderSizePixel = 0
    titleBarBottom.Parent = titleBar

    local title = Instance.new("TextLabel")
    title.Size = UDim2.new(1, -80, 1, 0)
    title.Position = UDim2.new(0, 10, 0, 0)
    title.BackgroundTransparency = 1
    title.Text = "Tiro Cego || By Branz"
    title.TextColor3 = Color3.fromRGB(255, 255, 255)
    title.Font = Enum.Font.GothamBold
    title.TextSize = 16
    title.TextXAlignment = Enum.TextXAlignment.Left
    title.Parent = titleBar

    local minimizeButton = Instance.new("TextButton")
    minimizeButton.Name = "MinimizeButton"
    minimizeButton.Size = UDim2.new(0, 30, 0, 30)
    minimizeButton.Position = UDim2.new(1, -70, 0.5, -15)
    minimizeButton.BackgroundColor3 = Color3.fromRGB(50, 50, 70)
    minimizeButton.Text = "-"
    minimizeButton.TextColor3 = Color3.fromRGB(255, 255, 255)
    minimizeButton.Font = Enum.Font.GothamBold
    minimizeButton.TextSize = 20
    minimizeButton.Parent = titleBar

    local minCorner = Instance.new("UICorner")
    minCorner.CornerRadius = UDim.new(0, 6)
    minCorner.Parent = minimizeButton

    local closeButton = Instance.new("TextButton")
    closeButton.Size = UDim2.new(0, 30, 0, 30)
    closeButton.Position = UDim2.new(1, -35, 0.5, -15)
    closeButton.BackgroundColor3 = Color3.fromRGB(200, 50, 50)
    closeButton.Text = "X"
    closeButton.TextColor3 = Color3.fromRGB(255, 255, 255)
    closeButton.Font = Enum.Font.GothamBold
    closeButton.TextSize = 16
    closeButton.Parent = titleBar

    local closeCorner = Instance.new("UICorner")
    closeCorner.CornerRadius = UDim.new(0, 6)
    closeCorner.Parent = closeButton

    local contentFrame = Instance.new("Frame")
    contentFrame.Name = "ContentFrame"
    contentFrame.Size = UDim2.new(1, -20, 1, -60)
    contentFrame.Position = UDim2.new(0, 10, 0, 50)
    contentFrame.BackgroundTransparency = 1
    contentFrame.Parent = mainFrame

    -- Botão View Players
    local viewButton = Instance.new("TextButton")
    viewButton.Size = UDim2.new(1, 0, 0, 40)
    viewButton.Position = UDim2.new(0, 0, 0, 0)
    viewButton.BackgroundColor3 = Color3.fromRGB(40, 40, 55)
    viewButton.Text = ""
    viewButton.Parent = contentFrame

    local viewCorner = Instance.new("UICorner")
    viewCorner.CornerRadius = UDim.new(0, 8)
    viewCorner.Parent = viewButton

    local viewLabel = Instance.new("TextLabel")
    viewLabel.Size = UDim2.new(1, -60, 1, 0)
    viewLabel.Position = UDim2.new(0, 10, 0, 0)
    viewLabel.BackgroundTransparency = 1
    viewLabel.Text = "View Players"
    viewLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
    viewLabel.Font = Enum.Font.Gotham
    viewLabel.TextSize = 14
    viewLabel.TextXAlignment = Enum.TextXAlignment.Left
    viewLabel.Parent = viewButton

    local viewToggle = Instance.new("Frame")
    viewToggle.Name = "Toggle"
    viewToggle.Size = UDim2.new(0, 45, 0, 25)
    viewToggle.Position = UDim2.new(1, -55, 0.5, -12.5)
    viewToggle.BackgroundColor3 = Color3.fromRGB(60, 60, 80)
    viewToggle.Parent = viewButton

    local viewToggleCorner = Instance.new("UICorner")
    viewToggleCorner.CornerRadius = UDim.new(1, 0)
    viewToggleCorner.Parent = viewToggle

    local viewCircle = Instance.new("Frame")
    viewCircle.Size = UDim2.new(0, 19, 0, 19)
    viewCircle.Position = UDim2.new(0, 3, 0.5, -9.5)
    viewCircle.BackgroundColor3 = Color3.fromRGB(200, 200, 220)
    viewCircle.Parent = viewToggle

    local viewCircleCorner = Instance.new("UICorner")
    viewCircleCorner.CornerRadius = UDim.new(1, 0)
    viewCircleCorner.Parent = viewCircle

    -- Botão ESP Players
    local espButton = Instance.new("TextButton")
    espButton.Size = UDim2.new(1, 0, 0, 40)
    espButton.Position = UDim2.new(0, 0, 0, 50)
    espButton.BackgroundColor3 = Color3.fromRGB(40, 40, 55)
    espButton.Text = ""
    espButton.Parent = contentFrame

    local espCorner = Instance.new("UICorner")
    espCorner.CornerRadius = UDim.new(0, 8)
    espCorner.Parent = espButton

    local espLabel = Instance.new("TextLabel")
    espLabel.Size = UDim2.new(1, -60, 1, 0)
    espLabel.Position = UDim2.new(0, 10, 0, 0)
    espLabel.BackgroundTransparency = 1
    espLabel.Text = "ESP Players"
    espLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
    espLabel.Font = Enum.Font.Gotham
    espLabel.TextSize = 14
    espLabel.TextXAlignment = Enum.TextXAlignment.Left
    espLabel.Parent = espButton

    local espToggle = Instance.new("Frame")
    espToggle.Name = "Toggle"
    espToggle.Size = UDim2.new(0, 45, 0, 25)
    espToggle.Position = UDim2.new(1, -55, 0.5, -12.5)
    espToggle.BackgroundColor3 = Color3.fromRGB(60, 60, 80)
    espToggle.Parent = espButton

    local espToggleCorner = Instance.new("UICorner")
    espToggleCorner.CornerRadius = UDim.new(1, 0)
    espToggleCorner.Parent = espToggle

    local espCircle = Instance.new("Frame")
    espCircle.Size = UDim2.new(0, 19, 0, 19)
    espCircle.Position = UDim2.new(0, 3, 0.5, -9.5)
    espCircle.BackgroundColor3 = Color3.fromRGB(200, 200, 220)
    espCircle.Parent = espToggle

    local espCircleCorner = Instance.new("UICorner")
    espCircleCorner.CornerRadius = UDim.new(1, 0)
    espCircleCorner.Parent = espCircle

    -- Sistema de arrastar
    local dragging = false
    local dragInput
    local dragStart
    local startPos
    
    local function updateDrag(input)
        local delta = input.Position - dragStart
        mainFrame.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
    end
    
    titleBar.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
            dragging = true
            dragStart = input.Position
            startPos = mainFrame.Position
            
            input.Changed:Connect(function()
                if input.UserInputState == Enum.UserInputState.End then
                    dragging = false
                end
            end)
        end
    end)
    
    titleBar.InputChanged:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch then
            dragInput = input
        end
    end)
    
    UserInputService.InputChanged:Connect(function(input)
        if input == dragInput and dragging then
            updateDrag(input)
        end
    end)

    -- Funcionalidade dos botões
    local isMinimized = false
    
    minimizeButton.MouseButton1Click:Connect(function()
        isMinimized = not isMinimized
        if isMinimized then
            TweenService:Create(mainFrame, TweenInfo.new(0.3), {Size = UDim2.new(0, 350, 0, 40)}):Play()
            contentFrame.Visible = false
            minimizeButton.Text = "+"
        else
            TweenService:Create(mainFrame, TweenInfo.new(0.3), {Size = UDim2.new(0, 350, 0, 200)}):Play()
            contentFrame.Visible = true
            minimizeButton.Text = "-"
        end
    end)

    closeButton.MouseButton1Click:Connect(function()
        screenGui:Destroy()
    end)

    viewButton.MouseButton1Click:Connect(function()
        viewPlayersEnabled = not viewPlayersEnabled
        toggleViewPlayers(viewPlayersEnabled)
        
        if viewPlayersEnabled then
            TweenService:Create(viewToggle, TweenInfo.new(0.2), {BackgroundColor3 = Color3.fromRGB(100, 150, 255)}):Play()
            TweenService:Create(viewCircle, TweenInfo.new(0.2), {Position = UDim2.new(0, 23, 0.5, -9.5)}):Play()
        else
            TweenService:Create(viewToggle, TweenInfo.new(0.2), {BackgroundColor3 = Color3.fromRGB(60, 60, 80)}):Play()
            TweenService:Create(viewCircle, TweenInfo.new(0.2), {Position = UDim2.new(0, 3, 0.5, -9.5)}):Play()
        end
    end)

    espButton.MouseButton1Click:Connect(function()
        espEnabled = not espEnabled
        toggleESP(espEnabled)
        
        if espEnabled then
            TweenService:Create(espToggle, TweenInfo.new(0.2), {BackgroundColor3 = Color3.fromRGB(100, 150, 255)}):Play()
            TweenService:Create(espCircle, TweenInfo.new(0.2), {Position = UDim2.new(0, 23, 0.5, -9.5)}):Play()
        else
            TweenService:Create(espToggle, TweenInfo.new(0.2), {BackgroundColor3 = Color3.fromRGB(60, 60, 80)}):Play()
            TweenService:Create(espCircle, TweenInfo.new(0.2), {Position = UDim2.new(0, 3, 0.5, -9.5)}):Play()
        end
    end)
end

-- Executar script
createLoadingScreen()
wait(3.5)
createMainGUI()
