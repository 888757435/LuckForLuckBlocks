-- PVP Trainer Op By Branzz

-- Servi√ßos
local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local player = Players.LocalPlayer

-- Vari√°veis globais
local savedPosition = nil
local flying = false
local flightSpeed = 28
local flightConnection = nil
local desyncV1Active = false
local desyncV2Active = false
local hitboxExpanded = false
local tpForwardActive = false
local fakeBody = nil
local hitboxPart = nil
local platforms = {}
local tpForwardConnection = nil

-- Criar a GUI principal
local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Name = "PVPTrainer"
ScreenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling

-- Frame principal
local MainFrame = Instance.new("Frame")
MainFrame.Name = "MainFrame"
MainFrame.Size = UDim2.new(0, 400, 0, 500)
MainFrame.Position = UDim2.new(0.5, -200, 0.5, -250)
MainFrame.BackgroundColor3 = Color3.fromRGB(45, 15, 70)
MainFrame.BackgroundTransparency = 0.1
MainFrame.BorderSizePixel = 0
MainFrame.ClipsDescendants = true
MainFrame.Parent = ScreenGui

-- Arrastar a GUI
local dragStart = nil
local startPos = nil

MainFrame.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        dragStart = input.Position
        startPos = MainFrame.Position
        input.Changed:Connect(function()
            if input.UserInputState == Enum.UserInputState.End then
                dragStart = nil
            end
        end)
    end
end)

MainFrame.InputChanged:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseMovement and dragStart then
        local delta = input.Position - dragStart
        MainFrame.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, 
                                        startPos.Y.Scale, startPos.Y.Offset + delta.Y)
    end
end)

-- Barra de t√≠tulo
local TitleBar = Instance.new("Frame")
TitleBar.Name = "TitleBar"
TitleBar.Size = UDim2.new(1, 0, 0, 30)
TitleBar.BackgroundColor3 = Color3.fromRGB(85, 25, 130)
TitleBar.BorderSizePixel = 0
TitleBar.Parent = MainFrame

-- T√≠tulo
local Title = Instance.new("TextLabel")
Title.Name = "Title"
Title.Size = UDim2.new(1, -60, 1, 0)
Title.Position = UDim2.new(0, 10, 0, 0)
Title.BackgroundTransparency = 1
Title.Text = "PVP Trainer Op By Branzz"
Title.TextColor3 = Color3.fromRGB(255, 255, 255)
Title.TextSize = 14
Title.Font = Enum.Font.GothamBold
Title.TextXAlignment = Enum.TextXAlignment.Left
Title.Parent = TitleBar

-- Bot√£o minimizar
local MinimizeButton = Instance.new("TextButton")
MinimizeButton.Name = "MinimizeButton"
MinimizeButton.Size = UDim2.new(0, 20, 0, 20)
MinimizeButton.Position = UDim2.new(1, -50, 0.5, -10)
MinimizeButton.BackgroundColor3 = Color3.fromRGB(120, 50, 180)
MinimizeButton.Text = "_"
MinimizeButton.TextColor3 = Color3.fromRGB(255, 255, 255)
MinimizeButton.TextSize = 16
MinimizeButton.Font = Enum.Font.GothamBold
MinimizeButton.Parent = TitleBar

-- Bot√£o fechar
local CloseButton = Instance.new("TextButton")
CloseButton.Name = "CloseButton"
CloseButton.Size = UDim2.new(0, 20, 0, 20)
CloseButton.Position = UDim2.new(1, -25, 0.5, -10)
CloseButton.BackgroundColor3 = Color3.fromRGB(180, 50, 50)
CloseButton.Text = "X"
CloseButton.TextColor3 = Color3.fromRGB(255, 255, 255)
CloseButton.TextSize = 14
CloseButton.Font = Enum.Font.GothamBold
CloseButton.Parent = TitleBar

-- Frame minimizado
local MinimizedFrame = Instance.new("Frame")
MinimizedFrame.Name = "MinimizedFrame"
MinimizedFrame.Size = UDim2.new(0, 200, 0, 30)
MinimizedFrame.Position = MainFrame.Position
MinimizedFrame.BackgroundColor3 = Color3.fromRGB(85, 25, 130)
MinimizedFrame.BorderSizePixel = 0
MinimizedFrame.Visible = false
MinimizedFrame.Parent = ScreenGui

local MinimizedTitle = Instance.new("TextLabel")
MinimizedTitle.Name = "MinimizedTitle"
MinimizedTitle.Size = UDim2.new(1, -40, 1, 0)
MinimizedTitle.Position = UDim2.new(0, 10, 0, 0)
MinimizedTitle.BackgroundTransparency = 1
MinimizedTitle.Text = "PVP Trainer Op By Branzz"
MinimizedTitle.TextColor3 = Color3.fromRGB(255, 255, 255)
MinimizedTitle.TextSize = 12
MinimizedTitle.Font = Enum.Font.GothamBold
MinimizedTitle.TextXAlignment = Enum.TextXAlignment.Left
MinimizedTitle.Parent = MinimizedFrame

local MaximizeButton = Instance.new("TextButton")
MaximizeButton.Name = "MaximizeButton"
MaximizeButton.Size = UDim2.new(0, 20, 0, 20)
MaximizeButton.Position = UDim2.new(1, -25, 0.5, -10)
MaximizeButton.BackgroundColor3 = Color3.fromRGB(120, 50, 180)
MaximizeButton.Text = "‚ñ°"
MaximizeButton.TextColor3 = Color3.fromRGB(255, 255, 255)
MaximizeButton.TextSize = 12
MaximizeButton.Font = Enum.Font.GothamBold
MaximizeButton.Parent = MinimizedFrame

-- Arrastar vers√£o minimizada
MinimizedFrame.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        dragStart = input.Position
        startPos = MinimizedFrame.Position
        input.Changed:Connect(function()
            if input.UserInputState == Enum.UserInputState.End then
                dragStart = nil
            end
        end)
    end
end)

MinimizedFrame.InputChanged:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseMovement and dragStart then
        local delta = input.Position - dragStart
        MinimizedFrame.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, 
                                            startPos.Y.Scale, startPos.Y.Offset + delta.Y)
    end
end)

-- Frame do conte√∫do
local ContentFrame = Instance.new("ScrollingFrame")
ContentFrame.Name = "ContentFrame"
ContentFrame.Size = UDim2.new(1, 0, 1, -30)
ContentFrame.Position = UDim2.new(0, 0, 0, 30)
ContentFrame.BackgroundTransparency = 1
ContentFrame.BorderSizePixel = 0
ContentFrame.ScrollBarThickness = 6
ContentFrame.ScrollBarImageColor3 = Color3.fromRGB(120, 50, 180)
ContentFrame.CanvasSize = UDim2.new(0, 0, 0, 750)
ContentFrame.Parent = MainFrame

-- Container
local ButtonContainer = Instance.new("Frame")
ButtonContainer.Name = "ButtonContainer"
ButtonContainer.Size = UDim2.new(1, -20, 0, 730)
ButtonContainer.Position = UDim2.new(0, 10, 0, 10)
ButtonContainer.BackgroundTransparency = 1
ButtonContainer.Parent = ContentFrame

-- Fun√ß√£o criar bot√£o
function createButton(name, text, position, height)
    local button = Instance.new("TextButton")
    button.Name = name
    button.Size = UDim2.new(1, 0, 0, height)
    button.Position = position
    button.BackgroundColor3 = Color3.fromRGB(65, 25, 100)
    button.Text = text
    button.TextColor3 = Color3.fromRGB(255, 255, 255)
    button.TextSize = 14
    button.Font = Enum.Font.Gotham
    button.AutoButtonColor = false
    
    local corner = Instance.new("UICorner")
    corner.CornerRadius = UDim.new(0, 6)
    corner.Parent = button
    
    return button
end

-- 1. Marcar Posi√ß√£o
local MarkButton = createButton("MarkButton", "Mark POSITION üìç", UDim2.new(0, 0, 0, 0), 35)
MarkButton.Parent = ButtonContainer

local MarkStatus = Instance.new("TextLabel")
MarkStatus.Name = "MarkStatus"
MarkStatus.Size = UDim2.new(1, 0, 0, 20)
MarkStatus.Position = UDim2.new(0, 0, 0, 40)
MarkStatus.BackgroundTransparency = 1
MarkStatus.Text = "Nenhuma posi√ß√£o salva"
MarkStatus.TextColor3 = Color3.fromRGB(200, 200, 200)
MarkStatus.TextSize = 12
MarkStatus.Font = Enum.Font.Gotham
MarkStatus.Parent = ButtonContainer

-- Bot√£o Limpar
local ClearButton = createButton("ClearButton", "Clear PositionüóëÔ∏è", UDim2.new(0, 0, 0, 65), 25)
ClearButton.BackgroundColor3 = Color3.fromRGB(180, 50, 50)
ClearButton.Parent = ButtonContainer

-- 2. Voo Livre (DO JEITO QUE ESTAVA)
local FlightButton = createButton("FlightButton", "V√¥o Livreü¶Ö: OFF", UDim2.new(0, 0, 0, 100), 35)
FlightButton.Parent = ButtonContainer

local FlightIndicator = Instance.new("Frame")
FlightIndicator.Name = "FlightIndicator"
FlightIndicator.Size = UDim2.new(0, 15, 0, 15)
FlightIndicator.Position = UDim2.new(1, -20, 0.5, -7.5)
FlightIndicator.BackgroundColor3 = Color3.fromRGB(180, 50, 50)
FlightIndicator.BorderSizePixel = 0
local flightCorner = Instance.new("UICorner")
flightCorner.CornerRadius = UDim.new(1, 0)
flightCorner.Parent = FlightIndicator
FlightIndicator.Parent = FlightButton

-- Fun√ß√£o voo (EXATAMENTE COMO NO SEU SCRIPT ORIGINAL)
local function toggleFlight()
    flying = not flying
    
    if flying then
        FlightButton.Text = "V√¥o Livreü¶Ö: ON"
        FlightIndicator.BackgroundColor3 = Color3.fromRGB(50, 180, 50)
        
        if flightConnection then
            flightConnection:Disconnect()
        end
        
        flightConnection = RunService.RenderStepped:Connect(function()
            if flying and player.Character then
                local camera = workspace.CurrentCamera
                local rootPart = player.Character:FindFirstChild("HumanoidRootPart")
                
                if camera and rootPart then
                    -- Move o personagem na dire√ß√£o que a c√¢mera est√° olhando
                    rootPart.Velocity = camera.CFrame.LookVector * flightSpeed
                end
            end
        end)
    else
        FlightButton.Text = "V√¥o Livreü¶Ö: OFF"
        FlightIndicator.BackgroundColor3 = Color3.fromRGB(180, 50, 50)
        
        if flightConnection then
            flightConnection:Disconnect()
            flightConnection = nil
        end
        
        if player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
            player.Character.HumanoidRootPart.Velocity = Vector3.new(0, 0, 0)
        end
    end
end

-- 3. TP Position
local TpButton = createButton("TpButton", "Tp POSITION üìç üåè", UDim2.new(0, 0, 0, 145), 35)
TpButton.Parent = ButtonContainer

-- Fun√ß√£o criar plataforma
local function createPlatform(position)
    local platform = Instance.new("Part")
    platform.Name = "TempPlatform"
    platform.Size = Vector3.new(10, 1, 10)
    platform.Position = position
    platform.Anchored = true
    platform.CanCollide = true
    platform.Transparency = 0.3
    platform.Color = Color3.fromRGB(255, 255, 255)
    platform.Parent = workspace
    
    table.insert(platforms, platform)
    
    -- Some ap√≥s 8 segundos
    task.delay(8, function()
        if platform and platform.Parent then
            platform:Destroy()
        end
    end)
    
    return platform
end

-- Fun√ß√£o TP com plataformas
local function teleportWithPlatforms()
    if not savedPosition then
        MarkStatus.Text = "Salve uma posi√ß√£o primeiro!"
        MarkStatus.TextColor3 = Color3.fromRGB(255, 100, 100)
        return
    end
    
    if not player.Character or not player.Character:FindFirstChild("HumanoidRootPart") then
        return
    end
    
    local root = player.Character.HumanoidRootPart
    local startPos = root.Position
    local direction = (savedPosition - startPos).Unit
    local distance = (savedPosition - startPos).Magnitude
    
    -- Ativar voo
    local wasFlying = flying
    if not flying then
        toggleFlight()
    end
    
    -- Criar plataformas a cada 3 segundos
    local platformInterval = 3
    local lastPlatformTime = tick()
    
    local startTime = tick()
    while tick() - startTime < (distance / flightSpeed) do
        if tick() - lastPlatformTime >= platformInterval then
            createPlatform(root.Position + Vector3.new(0, -5, 0))
            lastPlatformTime = tick()
        end
        task.wait()
    end
    
    -- Teleportar para posi√ß√£o exata
    root.CFrame = CFrame.new(savedPosition)
    
    -- Criar plataforma final
    createPlatform(savedPosition + Vector3.new(0, -5, 0))
    
    -- Desativar voo se n√£o estava ativo antes
    if not wasFlying then
        task.wait(0.5)
        toggleFlight()
    end
end

-- 4. Desync v1
local DesyncV1Button = createButton("DesyncV1Button", "Desync v1: OFF", UDim2.new(0, 0, 0, 190), 35)
DesyncV1Button.Parent = ButtonContainer

local DesyncV1Indicator = Instance.new("Frame")
DesyncV1Indicator.Name = "DesyncV1Indicator"
DesyncV1Indicator.Size = UDim2.new(0, 15, 0, 15)
DesyncV1Indicator.Position = UDim2.new(1, -20, 0.5, -7.5)
DesyncV1Indicator.BackgroundColor3 = Color3.fromRGB(180, 50, 50)
local desync1Corner = Instance.new("UICorner")
desync1Corner.CornerRadius = UDim.new(1, 0)
desync1Corner.Parent = DesyncV1Indicator
DesyncV1Indicator.Parent = DesyncV1Button

-- Fun√ß√£o Desync v1 (corpo parado, voc√™ se move livre)
local function toggleDesyncV1()
    desyncV1Active = not desyncV1Active
    
    if desyncV1Active then
        DesyncV1Button.Text = "Desync v1: ON"
        DesyncV1Indicator.BackgroundColor3 = Color3.fromRGB(50, 180, 50)
        
        if player.Character then
            -- Criar corpo falso parado
            fakeBody = player.Character:Clone()
            for _, part in pairs(fakeBody:GetChildren()) do
                if part:IsA("BasePart") then
                    part.Anchored = true
                    part.CanCollide = false
                    part.Transparency = 0.5
                end
            end
            fakeBody.Parent = workspace
            fakeBody:SetPrimaryPartCFrame(player.Character.HumanoidRootPart.CFrame)
            
            -- Tornar personagem real invis√≠vel
            for _, part in pairs(player.Character:GetChildren()) do
                if part:IsA("BasePart") then
                    part.Transparency = 1
                end
            end
        end
    else
        DesyncV1Button.Text = "Desync v1: OFF"
        DesyncV1Indicator.BackgroundColor3 = Color3.fromRGB(180, 50, 50)
        
        -- Remover corpo falso
        if fakeBody then
            fakeBody:Destroy()
            fakeBody = nil
        end
        
        -- Restaurar visibilidade
        if player.Character then
            for _, part in pairs(player.Character:GetChildren()) do
                if part:IsA("BasePart") then
                    part.Transparency = 0
                end
            end
        end
    end
end

-- 5. Desync v2
local DesyncV2Button = createButton("DesyncV2Button", "Desync v2: OFF", UDim2.new(0, 0, 0, 235), 35)
DesyncV2Button.Parent = ButtonContainer

local DesyncV2Indicator = Instance.new("Frame")
DesyncV2Indicator.Name = "DesyncV2Indicator"
DesyncV2Indicator.Size = UDim2.new(0, 15, 0, 15)
DesyncV2Indicator.Position = UDim2.new(1, -20, 0.5, -7.5)
DesyncV2Indicator.BackgroundColor3 = Color3.fromRGB(180, 50, 50)
local desync2Corner = Instance.new("UICorner")
desync2Corner.CornerRadius = UDim.new(1, 0)
desync2Corner.Parent = DesyncV2Indicator
DesyncV2Indicator.Parent = DesyncV2Button

-- Fun√ß√£o Desync v2
local function toggleDesyncV2()
    desyncV2Active = not desyncV2Active
    
    if desyncV2Active then
        DesyncV2Button.Text = "Desync v2: ON"
        DesyncV2Indicator.BackgroundColor3 = Color3.fromRGB(50, 180, 50)
        
        -- Aplicar FFlags do Desync.txt
        local FFlags = {
            GameNetPVHeaderRotationalVelocityZeroCutoffExponent = -5000,
            LargeReplicatorWrite5 = true,
            LargeReplicatorEnabled9 = true,
            AngularVelociryLimit = 360,
            TimestepArbiterVelocityCriteriaThresholdTwoDt = 2147483646,
            S2PhysicsSenderRate = 15000,
            DisableDPIScale = true,
            MaxDataPacketPerSend = 2147483647,
            PhysicsSenderMaxBandwidthBps = 20000,
            TimestepArbiterHumanoidLinearVelThreshold = 21,
            MaxMissedWorldStepsRemembered = -2147483648,
            PlayerHumanoidPropertyUpdateRestrict = true,
            SimDefaultHumanoidTimestepMultiplier = 0,
            StreamJobNOUVolumeLengthCap = 2147483647,
            DebugSendDistInSteps = -2147483648,
            GameNetDontSendRedundantNumTimes = 1,
            CheckPVLinearVelocityIntegrateVsDeltaPositionThresholdPercent = 1,
            CheckPVDifferencesForInterpolationMinVelThresholdStudsPerSecHundredth = 1,
            LargeReplicatorSerializeRead3 = true,
            ReplicationFocusNouExtentsSizeCutoffForPauseStuds = 2147483647,
            CheckPVCachedVelThresholdPercent = 10,
            CheckPVDifferencesForInterpolationMinRotVelThresholdRadsPerSecHundredth = 1,
            GameNetDontSendRedundantDeltaPositionMillionth = 1,
            InterpolationFrameVelocityThresholdMillionth = 5,
            StreamJobNOUVolumeCap = 2147483647,
            InterpolationFrameRotVelocityThresholdMillionth = 5,
            CheckPVCachedRotVelThresholdPercent = 10,
            WorldStepMax = 30,
            InterpolationFramePositionThresholdMillionth = 5,
            TimestepArbiterHumanoidTurningVelThreshold = 1,
            SimOwnedNOUCountThresholdMillionth = 2147483647,
            GameNetPVHeaderLinearVelocityZeroCutoffExponent = -5000,
            NextGenReplicatorEnabledWrite4 = true,
            TimestepArbiterOmegaThou = 1073741823,
            MaxAcceptableUpdateDelay = 1,
            LargeReplicatorSerializeWrite4 = true
        }
        
        for name, value in pairs(FFlags) do
            pcall(function()
                setfflag(tostring(name), tostring(value))
            end)
        end
    else
        DesyncV2Button.Text = "Desync v2: OFF"
        DesyncV2Indicator.BackgroundColor3 = Color3.fromRGB(180, 50, 50)
    end
end

-- 6. Hitbox Expande
local HitboxLabel = Instance.new("TextLabel")
HitboxLabel.Name = "HitboxLabel"
HitboxLabel.Size = UDim2.new(1, 0, 0, 25)
HitboxLabel.Position = UDim2.new(0, 0, 0, 280)
HitboxLabel.BackgroundTransparency = 1
HitboxLabel.Text = "Hitbox Expande:"
HitboxLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
HitboxLabel.TextSize = 14
HitboxLabel.Font = Enum.Font.GothamBold
HitboxLabel.TextXAlignment = Enum.TextXAlignment.Left
HitboxLabel.Parent = ButtonContainer

local HitboxSizeBox = Instance.new("TextBox")
HitboxSizeBox.Name = "HitboxSizeBox"
HitboxSizeBox.Size = UDim2.new(0.7, 0, 0, 30)
HitboxSizeBox.Position = UDim2.new(0, 0, 0, 310)
HitboxSizeBox.BackgroundColor3 = Color3.fromRGB(50, 20, 80)
HitboxSizeBox.TextColor3 = Color3.fromRGB(255, 255, 255)
HitboxSizeBox.Text = "15"
HitboxSizeBox.TextSize = 14
HitboxSizeBox.Font = Enum.Font.Gotham
HitboxSizeBox.PlaceholderText = "Tamanho"
HitboxSizeBox.Parent = ButtonContainer

local HitboxToggleButton = createButton("HitboxToggleButton", "Ativar Hitbox", UDim2.new(0.72, 5, 0, 310), 30)
HitboxToggleButton.Parent = ButtonContainer

-- Fun√ß√£o Hitbox
local function toggleHitbox()
    hitboxExpanded = not hitboxExpanded
    
    if hitboxExpanded then
        local size = tonumber(HitboxSizeBox.Text) or 15
        
        if player.Character then
            -- Criar hitbox
            hitboxPart = Instance.new("Part")
            hitboxPart.Name = "ExpandedHitbox"
            hitboxPart.Size = Vector3.new(size, size, size)
            hitboxPart.Transparency = 0.7
            hitboxPart.Color = Color3.fromRGB(255, 255, 255)
            hitboxPart.Material = EnumMaterial.Neon
            hitboxPart.CanCollide = false
            hitboxPart.Anchored = false
            hitboxPart.Parent = player.Character
            
            -- Conectar ao torso
            local torso = player.Character:FindFirstChild("Torso") or player.Character:FindFirstChild("UpperTorso")
            if torso then
                local weld = Instance.new("Weld")
                weld.Part0 = torso
                weld.Part1 = hitboxPart
                weld.C0 = CFrame.new(0, 0, 0)
                weld.Parent = hitboxPart
            end
            
            HitboxToggleButton.Text = "Desativar Hitbox"
            HitboxToggleButton.BackgroundColor3 = Color3.fromRGB(50, 180, 50)
        end
    else
        if hitboxPart then
            hitboxPart:Destroy()
            hitboxPart = nil
        end
        
        HitboxToggleButton.Text = "Ativar Hitbox"
        HitboxToggleButton.BackgroundColor3 = Color3.fromRGB(65, 25, 100)
    end
end

-- 7. TP Forward
local TpForwardLabel = Instance.new("TextLabel")
TpForwardLabel.Name = "TpForwardLabel"
TpForwardLabel.Size = UDim2.new(1, 0, 0, 25)
TpForwardLabel.Position = UDim2.new(0, 0, 0, 350)
TpForwardLabel.BackgroundTransparency = 1
TpForwardLabel.Text = "TP Forward:"
TpForwardLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
TpForwardLabel.TextSize = 14
TpForwardLabel.Font = Enum.Font.GothamBold
TpForwardLabel.TextXAlignment = Enum.TextXAlignment.Left
TpForwardLabel.Parent = ButtonContainer

local TpForwardBox = Instance.new("TextBox")
TpForwardBox.Name = "TpForwardBox"
TpForwardBox.Size = UDim2.new(0.7, 0, 0, 30)
TpForwardBox.Position = UDim2.new(0, 0, 0, 380)
TpForwardBox.BackgroundColor3 = Color3.fromRGB(50, 20, 80)
TpForwardBox.TextColor3 = Color3.fromRGB(255, 255, 255)
TpForwardBox.Text = "50"
TpForwardBox.TextSize = 14
TpForwardBox.Font = Enum.Font.Gotham
TpForwardBox.PlaceholderText = "Metros"
TpForwardBox.Parent = ButtonContainer

local TpForwardToggleButton = createButton("TpForwardToggleButton", "TP Forward: OFF", UDim2.new(0.72, 5, 0, 380), 30)
TpForwardToggleButton.Parent = ButtonContainer

local TpForwardIndicator = Instance.new("Frame")
TpForwardIndicator.Name = "TpForwardIndicator"
TpForwardIndicator.Size = UDim2.new(0, 10, 0, 10)
TpForwardIndicator.Position = UDim2.new(0.9, 0, 0.5, -5)
TpForwardIndicator.BackgroundColor3 = Color3.fromRGB(180, 50, 50)
local tpForwardCorner = Instance.new("UICorner")
tpForwardCorner.CornerRadius = UDim.new(1, 0)
tpForwardCorner.Parent = TpForwardIndicator
TpForwardIndicator.Parent = TpForwardToggleButton

-- Fun√ß√£o TP Forward
local function toggleTpForward()
    tpForwardActive = not tpForwardActive
    
    if tpForwardActive then
        TpForwardToggleButton.Text = "TP Forward: ON"
        TpForwardIndicator.BackgroundColor3 = Color3.fromRGB(50, 180, 50)
        
        if tpForwardConnection then
            tpForwardConnection:Disconnect()
        end
        
        tpForwardConnection = RunService.Heartbeat:Connect(function()
            if tpForwardActive and player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
                local distance = tonumber(TpForwardBox.Text) or 50
                local rootPart = player.Character.HumanoidRootPart
                local camera = workspace.CurrentCamera
                
                if camera then
                    local newPos = rootPart.Position + (camera.CFrame.LookVector * distance)
                    rootPart.CFrame = CFrame.new(newPos)
                end
            end
        end)
    else
        TpForwardToggleButton.Text = "TP Forward: OFF"
        TpForwardIndicator.BackgroundColor3 = Color3.fromRGB(180, 50, 50)
        
        if tpForwardConnection then
            tpForwardConnection:Disconnect()
            tpForwardConnection = nil
        end
    end
end

-- Conectar bot√µes
MarkButton.MouseButton1Click:Connect(function()
    if player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
        savedPosition = player.Character.HumanoidRootPart.Position
        MarkStatus.Text = string.format("Posi√ß√£o salva: (%.1f, %.1f, %.1f)", 
            savedPosition.X, savedPosition.Y, savedPosition.Z)
        MarkStatus.TextColor3 = Color3.fromRGB(50, 180, 50)
    end
end)

ClearButton.MouseButton1Click:Connect(function()
    savedPosition = nil
    MarkStatus.Text = "Nenhuma posi√ß√£o salva"
    MarkStatus.TextColor3 = Color3.fromRGB(200, 200, 200)
end)

FlightButton.MouseButton1Click:Connect(toggleFlight)
TpButton.MouseButton1Click:Connect(teleportWithPlatforms)
DesyncV1Button.MouseButton1Click:Connect(toggleDesyncV1)
DesyncV2Button.MouseButton1Click:Connect(toggleDesyncV2)
HitboxToggleButton.MouseButton1Click:Connect(toggleHitbox)
TpForwardToggleButton.MouseButton1Click:Connect(toggleTpForward)

-- Bot√µes da barra
MinimizeButton.MouseButton1Click:Connect(function()
    MinimizedFrame.Position = MainFrame.Position
    MinimizedFrame.Visible = true
    MainFrame.Visible = false
end)

MaximizeButton.MouseButton1Click:Connect(function()
    MainFrame.Position = MinimizedFrame.Position
    MainFrame.Visible = true
    MinimizedFrame.Visible = false
end)

CloseButton.MouseButton1Click:Connect(function()
    ScreenGui:Destroy()
    
    -- Limpar tudo
    if flightConnection then flightConnection:Disconnect() end
    if tpForwardConnection then tpForwardConnection:Disconnect() end
    
    for _, platform in pairs(platforms) do
        if platform and platform.Parent then
            platform:Destroy()
        end
    end
    
    if hitboxPart then hitboxPart:Destroy() end
    if fakeBody then fakeBody:Destroy() end
end)

-- Adicionar cantos arredondados
local MainCorner = Instance.new("UICorner")
MainCorner.CornerRadius = UDim.new(0, 8)
MainCorner.Parent = MainFrame

local TitleCorner = Instance.new("UICorner")
TitleCorner.CornerRadius = UDim.new(0, 8)
TitleCorner.Parent = TitleBar

local MinimizedCorner = Instance.new("UICorner")
MinimizedCorner.CornerRadius = UDim.new(0, 8)
MinimizedCorner.Parent = MinimizedFrame

-- Adicionar GUI
if game:GetService("CoreGui"):FindFirstChild("PVPTrainer") then
    game:GetService("CoreGui").PVPTrainer:Destroy()
end

ScreenGui.Parent = game:GetService("CoreGui")

print("PVP Trainer Op By Branzz - Tudo corrigido!")